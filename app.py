import streamlit as st
import yfinance as yf
import pandas as pd

# ==========================================
# 1. é é¢è¨­å®š (UI Layout)
# ==========================================
st.set_page_config(
    page_title="T100 æ™ºåŠ›å¤¥ä¼´é¸è‚¡ç³»çµ±",
    page_icon="ğŸ“ˆ",
    layout="wide"
)

st.title("ğŸš€ T100 ERP é¡§å•ç´šé¸è‚¡å„€è¡¨æ¿")
st.markdown("### æ ¸å¿ƒé‚è¼¯ï¼šåŸºæœ¬é¢ (PEä¼°å€¼) + æŠ€è¡“é¢ (MAé»ƒé‡‘äº¤å‰)")

# ==========================================
# 2. å´é‚Šæ¬„åƒæ•¸è¨­å®š
# ==========================================
with st.sidebar:
    st.header("âš™ï¸ ç³»çµ±åƒæ•¸è¨­å®š")
    st.info("é€™è£¡å¯ä»¥å‹•æ…‹èª¿æ•´æ¡è³¼ç­–ç•¥ï¼Œä¸éœ€æ”¹Codeã€‚")
    
    st.subheader("ä¼°å€¼æ¨™æº– (PE Ratio)")
    pe_tech_bull = st.slider("ç§‘æŠ€è‚¡-å¤šé ­ PE", 15, 30, 22)
    pe_tech_bear = st.slider("ç§‘æŠ€è‚¡-ç©ºé ­ PE", 10, 20, 14)
    pe_fin_bull  = st.slider("é‡‘è/å‚³ç”¢-å¤šé ­ PE", 10, 20, 15)
    
    run_btn = st.button("ğŸ”„ åŸ·è¡Œå…¨è‡ªå‹•æƒæ", type="primary")

# ==========================================
# 3. è³‡æ–™ä¾†æº (å°ç£50 - ä¸­æ–‡ä¸»æª”å°ç…§è¡¨)
# ==========================================
# é€™æ˜¯ä½ çš„ã€Œæ–™ä»¶ä¸»æª”ã€ï¼Œç¢ºä¿åç¨±é¡¯ç¤ºç‚ºä¸­æ–‡
tw50_dict = {
    '2330.TW': 'å°ç©é›»', '2317.TW': 'é´»æµ·', '2454.TW': 'è¯ç™¼ç§‘', '23
